<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Imagepinch by faceach</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <style type="text/css" media="screen">
    .main {
        margin: 50px auto;
    }
    .main pre {
        margin-top: 15px;
    }
    .flex-container {
        display: -webkit-flex;
        display: flex;
    }
    
    .flex-50 {
        -webkit-flex: 1;
        flex: 1;
    }
    
    .img-container {
        text-align: center;
        margin-top: 30px;
    }
    </style>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
    <div class="wrapper">
        <header>
            <h1>Imagepinch</h1>
            <p class="view"><a href="https://github.com/faceach/imagePinch">View the Project on GitHub <small>faceach/imagePinch</small></a></p>
            <ul>
                <li><a href="https://github.com/faceach/imagePinch/zipball/master">Download <strong>ZIP File</strong></a></li>
                <li><a href="https://github.com/faceach/imagePinch/tarball/master">Download <strong>TAR Ball</strong></a></li>
                <li><a href="https://github.com/faceach/imagePinch">View On <strong>GitHub</strong></a></li>
            </ul>
        </header>
        <div class="main">
            <h2>Upload Image Please:</h2>
            <input id="uploadBtn" type="file" accept="image/*">
            <pre><code>
    var imagePinch = new ImagePinch({
        file: file,
        toHeight: 400, // *px
        maxSize: 1024, // *kb
        success: function(file) {
            render(file, "imgpinched");
        }
    });
    imagePinch.pinch();
            </code></pre>
            <div class="flex-container img-container">
                <div class="flex-50">
                    <h2>Original picture</h2>
                    <div id="imgoriginal"></div>
                </div>
                <div class="flex-50">
                    <h2>Pinched picture</h2>
                    <div id="imgpinched"></div>
                </div>
            </div>
        </div>
        <footer>
            <p>This project is maintained by <a href="https://github.com/faceach">faceach</a></p>
            <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
        </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    <script src="imagePinch.js"></script>
    <script>
    function htmlLog(s, el, bgColor) {
        el = el || document.body;
        bgColor = bgColor || "#3f3";
        el.insertAdjacentHTML("beforeend", "<p style='background-color: " + bgColor + "; margin: 10px;'>" + s + "</p>");
    }

    function render(file, elId) {
        var img = new Image();
        img.src = window.URL.createObjectURL(file);
        img.width = 400;

        var el = document.getElementById(elId);
        while (el.hasChildNodes()) {
            el.removeChild(el.lastChild);
        }
        el.appendChild(img);
        // Log file to compare.
        htmlLog("File size: " + (file.size / 1024).toFixed(2) + "kb", el, "#3ff");

        var keys = Object.keys(file),
            i, len = keys.length;

        keys.sort();

        for (i = 0; i < len; i++) {
            k = keys[i];
            htmlLog(k + ": " + file[k], el);
        }
    }

    document.getElementById("uploadBtn").onchange = function() {
        var files = this.files;

        if (files.length === 0) {
            return;
        }

        var file = files[0];

        render(file, "imgoriginal");

        var imagePinch = new ImagePinch({
            file: file,
            toHeight: 400,
            maxSize: 1024,
            success: function(file) {
                render(file, "imgpinched");
            }
        });

        imagePinch.pinch();

    };
    </script>
</body>

</html>
